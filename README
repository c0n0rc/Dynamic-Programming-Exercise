Dynamic programming exercise. I believe there are one or two bugs.  
